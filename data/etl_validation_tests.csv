test_id,test_name,source_query,target_query,validation_type,enabled,description,severity
TEST_01,Total Record Count,SELECT COUNT(*) FROM LH_AX_CANADA.fullload.CUSTINVOICEJOUR,SELECT COUNT(*) FROM LH_Finance.dbo.CUSTINVOICEJOUR WHERE lhname='LH_AX_CANADA',row_count_comparison,TRUE,Validate total record count matches,blocker 
TEST_02,Total Record Count,SELECT COUNT(*) FROM LH_AX_CANADA.fullload.CUSTINVOICETRANS,SELECT COUNT(*) FROM LH_Finance.dbo.CUSTINVOICETRANS WHERE lhname='LH_AX_CANADA',row_count_comparison,TRUE,Validate total record count matches,critical 
TEST_03,Deleted Records Count,SELECT COUNT(*) FROM LH_AX_CANADA.fullload.CUSTINVOICEJOUR WHERE isdelete = 1,SELECT COUNT(*) FROM LH_Finance.dbo.CUSTINVOICEJOUR WHERE isdelete = 1 AND lhname='LH_AX_CANADA',row_count_comparison,TRUE,Validate deleted record count matches,blocker 
TEST_04,Deleted Records Count,SELECT COUNT(*) FROM LH_AX_CANADA.fullload.CUSTINVOICETRANS WHERE isdelete = 1,SELECT COUNT(*) FROM LH_Finance.dbo.CUSTINVOICETRANS WHERE isdelete = 1 AND lhname='LH_AX_CANADA',row_count_comparison,TRUE,Validate deleted record count matches,blocker 
TEST_05,Max Date Records,SELECT COUNT(*) FROM LH_AX_CANADA.fullload.CUSTINVOICEJOUR t WHERE t.dpcreateddatetime = t.dpmodifieddatetime AND t.DPCreatedDateTime = (SELECT MAX(dpcreateddatetime) FROM LH_AX_CANADA.fullload.CUSTINVOICEJOUR),SELECT COUNT(*) FROM LH_Finance.dbo.CUSTINVOICEJOUR t WHERE t.dpcreateddatetime = t.dpmodifieddatetime AND t.lhname = 'LH_AX_CANADA' AND t.DPCreatedDateTime = (SELECT MAX(dpcreateddatetime) FROM LH_Finance.dbo.CUSTINVOICEJOUR WHERE lhname='LH_AX_CANADA'),row_count_comparison,TRUE,Validate max date record count matches,normal 
TEST_06,Insert Records,"SELECT TOP 10 PERCENT recid, recversion, dpcreateddatetime, dpmodifieddatetime, isdelete FROM LH_AX_CANADA.fullload.CUSTINVOICEJOUR WHERE dpcreateddatetime = dpmodifieddatetime ORDER BY dpmodifieddatetime DESC","SELECT recid, recversion, dpcreateddatetime, dpmodifieddatetime, isdelete FROM LH_Finance.dbo.CUSTINVOICEJOUR WHERE dpcreateddatetime = dpmodifieddatetime AND lhname='LH_AX_CANADA' AND recid IN ({recid_list})",insert_record_validation,TRUE,Validate inserted records exist in Silver,minor 
TEST_07,Multi Table Total Record Count,"SELECT (SELECT COUNT(*) FROM LH_AX_CANADA.fullload.CUSTINVOICEJOUR) AS CUSTINVOICEJOUR, (SELECT COUNT(*) FROM LH_AX_CANADA.fullload.CUSTINVOICETRANS) AS CUSTINVOICETRANS, (SELECT COUNT(*) FROM LH_AX_CANADA.fullload.CUSTTABLE) AS CUSTTABLE, (SELECT COUNT(*) FROM LH_AX_CANADA.fullload.CUSTTRANS) AS CUSTTRANS, (SELECT COUNT(*) FROM LH_AX_CANADA.fullload.FISCALCALENDARPERIOD) AS FISCALCALENDARPERIOD, (SELECT COUNT(*) FROM LH_AX_CANADA.fullload.GENERALJOURNALENTRY) AS GENERALJOURNALENTRY, (SELECT COUNT(*) FROM LH_AX_CANADA.fullload.INVENTTRANS) AS INVENTTRANS, (SELECT COUNT(*) FROM LH_AX_CANADA.fullload.LEDGERJOURNALTRANS) AS LEDGERJOURNALTRANS, (SELECT COUNT(*) FROM LH_AX_CANADA.fullload.PURCHLINE) AS PURCHLINE, (SELECT COUNT(*) FROM LH_AX_CANADA.fullload.SALESLINE) AS SALESLINE, (SELECT COUNT(*) FROM LH_AX_CANADA.fullload.SALESTABLE) AS SALESTABLE, (SELECT COUNT(*) FROM LH_AX_CANADA.fullload.VENDINVOICEJOUR) AS VENDINVOICEJOUR, (SELECT COUNT(*) FROM LH_AX_CANADA.fullload.VENDTRANS) AS VENDTRANS, (SELECT COUNT(*) FROM LH_AX_CANADA.fullload.WORKFLOWTRACKINGSTATUSTABLE) AS WORKFLOWTRACKINGSTATUSTABLE","SELECT (SELECT COUNT(*) FROM LH_Finance.dbo.CUSTINVOICEJOUR WHERE lhname='LH_AX_CANADA') AS CUSTINVOICEJOUR, (SELECT COUNT(*) FROM LH_Finance.dbo.CUSTINVOICETRANS WHERE lhname='LH_AX_CANADA') AS CUSTINVOICETRANS, (SELECT COUNT(*) FROM LH_Finance.dbo.CUSTTABLE WHERE lhname='LH_AX_CANADA') AS CUSTTABLE, (SELECT COUNT(*) FROM LH_Finance.dbo.CUSTTRANS WHERE lhname='LH_AX_CANADA') AS CUSTTRANS, (SELECT COUNT(*) FROM LH_Finance.dbo.FISCALCALENDARPERIOD WHERE lhname='LH_AX_CANADA') AS FISCALCALENDARPERIOD, (SELECT COUNT(*) FROM LH_Finance.dbo.GENERALJOURNALENTRY WHERE lhname='LH_AX_CANADA') AS GENERALJOURNALENTRY, (SELECT COUNT(*) FROM LH_Finance.dbo.INVENTTRANS WHERE lhname='LH_AX_CANADA') AS INVENTTRANS, (SELECT COUNT(*) FROM LH_Finance.dbo.LEDGERJOURNALTRANS WHERE lhname='LH_AX_CANADA') AS LEDGERJOURNALTRANS, (SELECT COUNT(*) FROM LH_Finance.dbo.PURCHLINE WHERE lhname='LH_AX_CANADA') AS PURCHLINE, (SELECT COUNT(*) FROM LH_Finance.dbo.SALESLINE WHERE lhname='LH_AX_CANADA') AS SALESLINE, (SELECT COUNT(*) FROM LH_Finance.dbo.SALESTABLE WHERE lhname='LH_AX_CANADA') AS SALESTABLE, (SELECT COUNT(*) FROM LH_Finance.dbo.VENDINVOICEJOUR WHERE lhname='LH_AX_CANADA') AS VENDINVOICEJOUR, (SELECT COUNT(*) FROM LH_Finance.dbo.VENDTRANS WHERE lhname='LH_AX_CANADA') AS VENDTRANS, (SELECT COUNT(*) FROM LH_Finance.dbo.WORKFLOWTRACKINGSTATUSTABLE WHERE lhname='LH_AX_CANADA') AS WORKFLOWTRACKINGSTATUSTABLE",row_count_comparison,TRUE,Validate total record count matches for multiple tables,critical
TEST_08,Insert Records - CUSTINVOICEJOUR,"SELECT TOP 10 PERCENT recid, recversion, dpcreateddatetime, dpmodifieddatetime, isdelete FROM LH_AX_CANADA.fullload.CUSTINVOICEJOUR WHERE dpcreateddatetime = dpmodifieddatetime ORDER BY dpmodifieddatetime DESC","SELECT recid, recversion, dpcreateddatetime, dpmodifieddatetime, isdelete FROM LH_Finance.dbo.CUSTINVOICEJOUR WHERE dpcreateddatetime = dpmodifieddatetime AND lhname='LH_AX_CANADA' AND recid IN ({recid_list})",insert_record_validation,TRUE,Validate inserted records exist in Silver for CUSTINVOICEJOUR,minor
TEST_09,Insert Records - SALESTABLE,"SELECT TOP 10 PERCENT recid, recversion, dpcreateddatetime, dpmodifieddatetime, isdelete FROM LH_AX_CANADA.fullload.SALESTABLE WHERE dpcreateddatetime = dpmodifieddatetime ORDER BY dpmodifieddatetime DESC","SELECT recid, recversion, dpcreateddatetime, dpmodifieddatetime, isdelete FROM LH_Finance.dbo.SALESTABLE WHERE dpcreateddatetime = dpmodifieddatetime AND lhname='LH_AX_CANADA' AND recid IN ({recid_list})",insert_record_validation,TRUE,Validate inserted records exist in Silver for SALESTABLE,minor
TEST_10,Insert Records - 3 Tables,"WITH Combined AS (SELECT TOP 10 PERCENT 'CUSTINVOICEJOUR' AS TableName, recid, recversion, dpcreateddatetime, dpmodifieddatetime, isdelete FROM LH_AX_CANADA.fullload.CUSTINVOICEJOUR WHERE dpcreateddatetime = dpmodifieddatetime UNION ALL SELECT TOP 10 PERCENT 'SALESTABLE', recid, recversion, dpcreateddatetime, dpmodifieddatetime, isdelete FROM LH_AX_CANADA.fullload.SALESTABLE WHERE dpcreateddatetime = dpmodifieddatetime UNION ALL SELECT TOP 10 PERCENT 'INVENTTRANS', recid, recversion, dpcreateddatetime, dpmodifieddatetime, isdelete FROM LH_AX_CANADA.fullload.INVENTTRANS WHERE dpcreateddatetime = dpmodifieddatetime) SELECT * FROM Combined","WITH Combined AS (SELECT 'CUSTINVOICEJOUR' AS TableName, recid, recversion, dpcreateddatetime, dpmodifieddatetime, isdelete FROM LH_Finance.dbo.CUSTINVOICEJOUR WHERE dpcreateddatetime = dpmodifieddatetime AND lhname='LH_AX_CANADA' AND recid IN ({recid_list}) UNION ALL SELECT 'SALESTABLE', recid, recversion, dpcreateddatetime, dpmodifieddatetime, isdelete FROM LH_Finance.dbo.SALESTABLE WHERE dpcreateddatetime = dpmodifieddatetime AND lhname='LH_AX_CANADA' AND recid IN ({recid_list}) UNION ALL SELECT 'INVENTTRANS', recid, recversion, dpcreateddatetime, dpmodifieddatetime, isdelete FROM LH_Finance.dbo.INVENTTRANS WHERE dpcreateddatetime = dpmodifieddatetime AND lhname='LH_AX_CANADA' AND recid IN ({recid_list})) SELECT * FROM Combined",insert_record_validation_group,TRUE,Validate inserted records exist in Silver for 3 tables,minor
